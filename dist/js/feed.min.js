/*! sdhm-event-feed v2.0.0 | (c) 2020 San Diego House Music | MIT License | https://github.com/djmisha/event-feed */
function get(e){return document.querySelector(e)}function createMarkUp(e,t,a){return element=document.createElement(e),t.length>0&&(element.classList=t.join(" ")),a&&(element.innerHTML=a),element}function removeDuplicates(e){return e.filter((t,a)=>e.indexOf(t)===a)}function navigationDropdowns(){var e=document.getElementById("venue-list"),t=document.getElementById("artist-list"),a=document.getElementById("date-list"),n=document.getElementById("city-list");function i(e){toggler=e.previousElementSibling,toggler.addEventListener("click",(function(){e.classList.contains("visible")?(e.classList.remove("visible"),e.parentElement.classList.remove("visible")):(e.classList.add("visible"),e.parentElement.classList.add("visible"))}))}i(e),i(t),i(a),i(n)}var todaysDate=Date.now(),theFeed=document.getElementById("evenfeed"),eventData=[],locationsData=[],imageData=[];function requestImagesXHR(){var e=new XMLHttpRequest;e.open("GET","images.json"),e.send(),e.onreadystatechange=function(){e.readyState===XMLHttpRequest.DONE&&200===e.status&&(!(function(e){for(var t=0;t<e.length;t++){var a={url:e[t].url,id:e[t].id};imageData.push(a)}})(JSON.parse(e.responseText)),matchImageswithEvents(imageData))}}function requestLocationsXHR(){var e=new XMLHttpRequest;e.open("GET","locations.json"),e.send(),e.onreadystatechange=function(){e.readyState===XMLHttpRequest.DONE&&200===e.status&&(function(e){for(var t=0;t<e.length;t++){var a={id:e[t].id,city:e[t].city,state:e[t].state};locationsData.push(a)}})(JSON.parse(e.responseText))}}function requestEventsXHR(e){theFeed.innerHTML="",eventData=[];var t=new XMLHttpRequest,a="https://edmtrain.com/api/events?locationIds="+e+"&client="+config.theGoods;t.open("GET",a),t.send(),t.onreadystatechange=function(){t.readyState===XMLHttpRequest.DONE&&200===t.status&&(!(function(e){for(var t=0;t<e.data.length;t++){Date.parse(e.data[t].date);var a=new Date(e.data[t].date),n=new Date(e.data[t].date).toDateString(),i={id:e.data[t].id,name:e.data[t].name,date:n,link:e.data[t].link,venuename:e.data[t].venue.name,venueaddress:e.data[t].venue.address,venuecity:e.data[t].venue.location,venuestate:e.data[t].venue.state,artist:[e.data[t].artistList],image:"",schemadate:a};eventData.push(i)}})(JSON.parse(t.responseText)),attachToPage())}}function attachToPage(){new Blazy({});for(var e=0;e<eventData.length;e++){var t=document.createElement("div");t.classList.add("single-event"),t.setAttribute("itemscope",""),t.setAttribute("data-id",eventData[e].id),t.setAttribute("itemtype","http://schema.org/Event"),t.innerHTML=createMarkUpforEvent(eventData[e]),theFeed.appendChild(t),t.addEventListener("click",(function(e){e.preventDefault(),console.log(e),console.log(this)}))}createSortingNavigations()}function createSortingNavigations(){var e=document.getElementById("city-list");e.innerHTML="";var t=[];locationsData.forEach((function(e){var a={id:e.id,city:e.city};a.city&&t.push(a)})),t.forEach((function(t){var a=document.createElement("div");a.innerHTML=t.city,e.appendChild(a);var n=t.id,i=t.city;a.addEventListener("click",(function(e){city=document.getElementById("city-list"),cityName=get(".sort-city #drop-trigger"),cityName.innerHTML=i,city.classList.remove("visible"),city.parentElement.classList.remove("visible"),requestEventsXHR(n)}))}));var a=document.getElementById("venue-list");a.innerHTML="";var n=[];eventData.forEach((function(e){var t=e.venuename;n.push(t)})),(n=removeDuplicates(n)).forEach((function(e){var t=document.createElement("div");t.innerHTML=e,a.appendChild(t),t.addEventListener("click",c)}));var i=document.getElementById("artist-list");i.innerHTML="",artistArray=[],eventData.forEach((function(e){e.artist.forEach((function(e){e.forEach((function(e){artistArray.push(e.name)}))}))})),artistArray=removeDuplicates(artistArray),artistArray.forEach((function(e){var t=document.createElement("div");t.innerHTML=e,i.appendChild(t),t.addEventListener("click",c)}));var s=document.getElementById("date-list"),r=[];function c(){console.log(this.parentElement),this.parentElement.classList.remove("visible");var e=document.getElementById("input-search"),t=document.getElementById("submit-search");e.value=this.innerHTML,t.click()}eventData.forEach((function(e){var t=e.date;r.push(t)})),(r=removeDuplicates(r)).forEach((function(e){var t=document.createElement("div");t.innerHTML=e,s.appendChild(t),t.addEventListener("click",c)}))}function listArtists(e){var t=[];for(a=0;a<e.artist.length;a++){for(b=0;b<e.artist[a].length;b++){var n='<div class="artist artist-'+b+'"><a href="'+e.artist[a][b].link+'" target="_blank">'+e.artist[a][b].name+"</a>&nbsp;</div>";t.push(n)}return t}}function checkEventName(e){return!1==!e.name?e.name:""}function matchImageswithEvents(e,t){for(i=0;i<e.length;i++)if(t===e[i].id)return artistImage=e[i].url,artistImage}function createMarkUpforEvent(e){var t=e.id,a=matchImageswithEvents(imageData,t),n=listArtists(e),i=checkEventName(e);return'<div class="event-date" itemprop="startDate" content="'+e.schemadate+'">'+e.date+"</div> \n<a href="+e.link+' target=_blank><div class="event-image b-lazy" data-src="'+a+'"></div></a> \n<div class="event-title" itemprop="name">'+i+'</div> \n<div class="event-artist" itemprop="name">'+n+'</div> \n<div class="event-venue" itemprop="location" itemscope itemtype="http://schema.org/Place"><a href="https://www.google.com/maps/search/'+e.venuename+" "+e.venueaddress+'" target=_blank><span itemprop="name">'+e.venuename+'</span></a> \n<div class="event-location" itemscope itemtype="http://schema.org/PostalAddress"  itemprop="address" content="'+e.venueaddress+'"><a href="https://www.google.com/maps/search/'+e.venuename+" "+e.venueaddress+'" target=_blank><span>'+e.venueaddress+'</span></a></div></div> \n<div class="event-link"><a href='+e.link+' target="_blank">Learn More</a></div> \n'}theFeed&&(requestLocationsXHR(),requestImagesXHR(),requestEventsXHR(81),navigationDropdowns());