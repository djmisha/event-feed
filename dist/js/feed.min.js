/*! sdhm-event-feed v2.0.0 | (c) 2020 San Diego House Music | MIT License | https://github.com/djmisha/event-feed */
var venueMenu=document.getElementById("venue-list"),dateMenu=document.getElementById("date-list");function navToggles(e){toggler=e.previousElementSibling,toggler.addEventListener("click",(function(){e.classList.contains("visibile")?e.classList.remove("visibile"):e.classList.add("visibile")}))}navToggles(venueMenu),navToggles(dateMenu);var todaysDate=Date.now(),theFeed=document.getElementById("evenfeed"),eventData=[],imageData=[];function requestImagesXHR(){var e=new XMLHttpRequest;e.open("GET","images.json"),e.send(),e.onreadystatechange=function(){e.readyState===XMLHttpRequest.DONE&&200===e.status&&(!(function(e){for(var t=0;t<e.length;t++){var a={url:e[t].url,id:e[t].id};imageData.push(a)}})(JSON.parse(e.responseText)),matchImageswithEvents(imageData))}}function requestEventsXHR(){var e=new XMLHttpRequest,t="https://edmtrain.com/api/events?locationIds=81&client="+config.theGoods;e.open("GET",t),e.send(),e.onreadystatechange=function(){e.readyState===XMLHttpRequest.DONE&&200===e.status&&(!(function(e){for(var t=0;t<e.data.length;t++){Date.parse(e.data[t].date);var a=new Date(e.data[t].date),n=new Date(e.data[t].date).toDateString(),s={id:e.data[t].id,name:e.data[t].name,date:n,link:e.data[t].link,venuename:e.data[t].venue.name,venueaddress:e.data[t].venue.address,venuecity:e.data[t].venue.location,venuestate:e.data[t].venue.state,artist:[e.data[t].artistList],image:"",schemadate:a};eventData.push(s)}})(JSON.parse(e.responseText)),attachToPage())}}function attachToPage(){new Blazy({});for(var e=0;e<eventData.length;e++){var t=document.createElement("div");t.classList.add("single-event"),t.setAttribute("itemscope",""),t.setAttribute("data-id",eventData[e].id),t.setAttribute("itemtype","http://schema.org/Event"),t.innerHTML=createMarkUpforEvent(eventData[e]),theFeed.appendChild(t)}function a(e){return e.filter((t,a)=>e.indexOf(t)===a)}var n=document.getElementById("venue-list"),s=[];eventData.forEach((function(e){var t=e.venuename;s.push(t)})),(s=a(s)).forEach((function(e){var t=document.createElement("div");t.innerHTML=e,n.appendChild(t),t.addEventListener("click",d)}));var i=document.getElementById("date-list"),r=[];function d(){console.log(this.parentElement),this.parentElement.classList.remove("visibile");var e=document.getElementById("input-search"),t=document.getElementById("submit-search");e.value=this.innerHTML,t.click()}eventData.forEach((function(e){var t=e.date;r.push(t)})),r=a(r),console.log(i),r.forEach((function(e){var t=document.createElement("div");t.innerHTML=e,i.appendChild(t),t.addEventListener("click",d)}))}function listArtists(e){var t=[];for(a=0;a<e.artist.length;a++){for(b=0;b<e.artist[a].length;b++){var n='<div class="artist artist-'+b+'"><a href="'+e.artist[a][b].link+'" target="_blank">'+e.artist[a][b].name+"</a>&nbsp;</div>";t.push(n)}return t}}function checkEventName(e){return!1==!e.name?e.name:""}function matchImageswithEvents(e,t){for(i=0;i<e.length;i++)if(t===e[i].id)return artistImage=e[i].url,artistImage}function createMarkUpforEvent(e){var t=e.id,a=matchImageswithEvents(imageData,t),n=listArtists(e),s=checkEventName(e);return'<div class="event-date" itemprop="startDate" content="'+e.schemadate+'">'+e.date+"</div> \n<a href="+e.link+' target=_blank><div class="event-image b-lazy" data-src="'+a+'"></div></a> \n<div class="event-title" itemprop="name">'+s+'</div> \n<div class="event-artist" itemprop="name">'+n+'</div> \n<div class="event-venue" itemprop="location" itemscope itemtype="http://schema.org/Place"><a href="https://www.google.com/maps/search/'+e.venuename+" "+e.venueaddress+'" target=_blank><span itemprop="name">'+e.venuename+'</span></a> \n<div class="event-location" itemscope itemtype="http://schema.org/PostalAddress"  itemprop="address" content="'+e.venueaddress+'"><a href="https://www.google.com/maps/search/'+e.venuename+" "+e.venueaddress+'" target=_blank><span>'+e.venueaddress+'</span></a></div></div> \n<div class="event-link"><a href='+e.link+' target="_blank">Learn More</a></div> \n'}theFeed&&(requestImagesXHR(),requestEventsXHR());